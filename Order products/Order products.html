<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | Football Store</title>
  <link href="https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="Order products.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo-section">
      <img src="../uploads/h0-Photoroom.jpg" alt="Logo" class="logo-icon" />
      <h1>Football Store</h1>
    </div>

    <div class="nav-links">
      <a href="../index/index.html"><i class="fas fa-home"></i> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
      <a href="../Product/basket.html"><i class="fas fa-shopping-cart"></i> ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</a>
      <a href="../order-history/order-history.html"><i class="fas fa-receipt"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</a>
    </div>

    <div class="profile-section">
      <img src="../uploads/iconprofile.jpg" alt="‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå" id="profileIcon" class="profile-icon" />
      <div class="dropdown" id="profileDropdown">
        <div class="profile-info">
          <img id="userImg" src="../uploads/iconprofile.jpg" alt="User Image" />
          <h4 class="userFullname-nav">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</h4>
          <p class="userEmail-nav">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
        </div>
        <div class="profile-buttons">
          <button class="edit-btn" onclick="window.location.href='../Edit_profile/edit_profile.html'">
            <i class="fas fa-user-edit"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
          </button>
          <button class="logout-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
  <div class="order-container">
    <h2>üõçÔ∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h2>

    <!-- ‚úÖ ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
    <div class="user-info" style="
      margin: 15px 0;
      background: #e3f2fd;
      padding: 14px 18px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    ">
      <p><b>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</b> <span id="userFullname" style="color:#0d47a1;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></p>
      <p><b>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</b> <span id="userEmail" style="color:#0d47a1;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></p>
    </div>

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <div id="orderList"></div>

    <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
    <div class="order-status">
      <span id="orderStatus"></span>
      <span id="countdown"></span>
      <div id="paymentInfo" style="margin-top:10px;color:#0d47a1;font-weight:600;"></div>
    </div>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -->
    <div class="payment-section" id="paymentSection">
      <h3>üí≥ ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
      <p class="bank-info">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£: <b id="bankAccount">096-401-4011</b> (Football Store)</p>

      <div class="qr-box">
        <img id="qrImage" src="../uploads/placeholder.png" alt="QR Code ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"
          onerror="this.onerror=null;this.src='../uploads/noimage.png';">
        <p class="amount">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞: <span id="totalAmount">0</span> ‡∏ö‡∏≤‡∏ó</p>
        <p class="scan-text">üì± ‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
      </div>

      <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î -->
      <div class="upload-box" id="uploadBox">
        <label for="receiptImg">üì§ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
        <input type="file" id="receiptImg" accept="image/*">
        <div id="previewImg"></div>
        <p class="filename"></p>
        <button id="payBtn" class="btn confirm"><i class="fas fa-upload"></i> ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</button>
      </div>
    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πà‡∏≤‡∏á -->
    <div class="actions">
      <button id="cancelBtn" class="btn cancel"><i class="fas fa-times"></i> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
      <a href="../order-history/order-history.html" class="btn history"><i class="fas fa-clock"></i> ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</a>
    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö -->
    <div class="nav-icons">
      <a href="../index/index.html"><i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    </div>
  </div>

  <footer>
    <h4>Football Store</h4>
    <p>‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ ‚öΩ | ¬© 2025 All Rights Reserved</p>
  </footer>

  <!-- Script ‡∏´‡∏•‡∏±‡∏Å -->
  <script src="Order products.js"></script>

  <script>
    /* ===============================
       ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå Navbar ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    =============================== */
    const profileIcon = document.getElementById("profileIcon");
    const profileDropdown = document.getElementById("profileDropdown");

    // ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î dropdown
    profileIcon.addEventListener("click", () => profileDropdown.classList.toggle("show"));
    document.addEventListener("click", (e) => {
      if (!profileDropdown.contains(e.target) && e.target !== profileIcon)
        profileDropdown.classList.remove("show");
    });

    function logout() {
      localStorage.clear();
      window.location.href = "../Login/Login.html";
    }

    // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
    window.addEventListener("DOMContentLoaded", async () => {
      try {
        const res = await fetch("../index/check_login.php", { credentials: "include" });
        const user = await res.json();

        if (!user.loggedIn) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£");
          window.location.href = "../Login/Login.html";
          return;
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏à‡∏∏‡∏î
        document.querySelectorAll("#userFullname").forEach(el => el.textContent = `${user.firstname} ${user.lastname}`);
        document.querySelectorAll("#userEmail").forEach(el => el.textContent = user.email);
        document.querySelectorAll(".userFullname-nav").forEach(el => el.textContent = `${user.firstname} ${user.lastname}`);
        document.querySelectorAll(".userEmail-nav").forEach(el => el.textContent = user.email);
        document.getElementById("userImg").src = "../uploads/iconprofile.jpg";
        document.getElementById("profileIcon").src = "../uploads/iconprofile.jpg";

        // ‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á localStorage ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Order products.js ‡πÉ‡∏ä‡πâ
        localStorage.setItem("userEmail", user.email);
        localStorage.setItem("userName", `${user.firstname} ${user.lastname}`);
      } catch (err) {
        console.error("‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", err);
      }
    });

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• order ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
    window.showPaymentInfo = function(order_number, email, fullname, status) {
      document.getElementById("paymentInfo").innerHTML =
        `<div>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: <b>${order_number || '-'}</b></div>
         <div>‡∏≠‡∏µ‡πÄ‡∏°‡∏•: <b>${email || '-'}</b></div>
         <div>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•: <b>${fullname || '-'}</b></div>
         <div>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô: <span style="color:#e53935">${status || '-'}</span></div>`;
    };
  </script>
</body>
</html>
